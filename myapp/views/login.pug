//- 2022-09-19
//- Philippe C. Léger
//- Page login: Page utilisée pour 

extends layout

block content
    include utilities
    //- - const errorUsername = "Nom d'utilisateur invalide";
    //- - const errorPassword = "Mot de passe invalide";
    //- - const username = "MyUsername";
    //- - const password = "MyPassword";
    .center-h
        .center-v
            .container-dark
                form(action="./login" method="post" id="loginForm")
                    p.lbl-light Nom d'utilisateur
                    input(type="text" name="username" id="username" value=username).input-dark
                    +errorLabel(errorUsername, "errorUsername")
                    p.lbl-light Mot de passe
                    input(type="password" name="password" id="password").input-dark
                    +errorLabel(errorPassword, "errorPassword")
                    input(type="submit", value="Envoyer").btn-dark
    script(src="./scripts/login.js") 
    script.
        //- const validationLogin = require("./scripts/login.js");
        const validationLogin = this.loginValidation;
        //- import {exports} from './scripts/login.js';
        console.log(this);
        console.log("Allo!");
        console.log(validationLogin);
        $(document).ready(() => {
            console.log("load()");
            setOnSubmit();
        });

        function setOnSubmit(){
            console.log("setOnSubmit()")
            $("#loginForm").submit((e) => {
                e.preventDefault();
                const username = $("#username").val();
                const password = $("#password").val();
                const errorUsername = validationLogin.getUsernameValidationText(username);
                const errorPassword = validationLogin.getPasswordValidationText(password);
                if(errorUsername != "" || errorPassword != ""){
                    console.log("invalide local");
                    console.log(`errorUsername: ${errorUsername}`);
                    console.log(`errorPassword: ${errorPassword}`);
                    $("#errorUsername").text(errorUsername + " local")
                    $("#errorPassword").text(errorPassword + " local");
                } else { console.log("valide local")}
            })
        }